<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Tony's SkyView Portfolio - 9:16 Shorts</title>
<!-- Tailwind CSS -->
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<!-- Google Fonts (Inter) -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
<style>
  /* * Design System Variables */
  :root{ 
    --brand-dark:#1f3556; 
    --brand:#2b5aa6; 
    --brand-hover:#234b8b; 
    --accent:#7b1fa2;
    --card-bg:#ffffff; 
    --page-bg:#f2f2f2; 
    --text:#111827; 
    --muted:#6b7280; 
  }
  
  /* Dark Mode Support */
  @media (prefers-color-scheme: dark){
    :root{ 
      --card-bg:#111827; 
      --page-bg:#0b1220; 
      --text:#e5e7eb; 
      --muted:#9ca3af;
      --brand-dark:#162640; 
      --brand:#2b5aa6; 
      --brand-hover:#234b8b; 
      --accent:#8b5cf6; 
    }
  }

  body{ font-family:'Inter',sans-serif; background:var(--page-bg); color:var(--text); }
  
  /* Header Section */
  .header{
    background-image:url('https://yt3.googleusercontent.com/JHTHRsm3_keOY7f6dLzgDkG7e_olnUvd9Nd0hNfcCbGDScdnOyKDFmuaARWFX05zWaPjwjsAJw=w1707-fcrop64=1,00005a57ffffa5a8-k-c0xffffffff-no-nd-rj');
    background-size:cover;
    background-position:center;
    height:250px;
    color:#fff;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:48px;
    font-weight:900;
    text-align:center;
    text-shadow: 2px 2px 6px rgba(0,0,0,0.7);
  }
  
  /* Navigation */
  .navbar{ background:var(--brand-dark); }
  .nav-btn{
    background:var(--brand); 
    color:#fff; 
    border:none; 
    padding:10px 20px; 
    margin:0 5px; 
    border-radius:8px;
    text-decoration:none; 
    font-size:14px; 
    transition:background .25s ease;
    min-width:110px;
    text-align:center;
    display:inline-block;
  }
  .nav-btn:hover{ background:var(--brand-hover); }
  
  /* Intro Banner */
  .intro{
    background: linear-gradient(90deg, var(--brand), var(--accent));
    color: #ffffff;
    font-size: 1.25rem;
    font-weight: 700;
    line-height: 1.8;
    padding: 1.5rem;
    border-radius: 12px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.18);
    text-align: center;
    max-width: 70%;
    margin: 2rem auto;
    border: 0;
  }
  
  .video-section-title{ color:var(--brand-dark); font-size:2rem; font-weight:800; margin-bottom:1rem; }
  @media (prefers-color-scheme:dark){ .video-section-title{ color:#cbd5e1; } }
  
  /* Grid Layout for Shorts (Vertical Cards) */
  .grid{ display:grid; grid-template-columns:repeat(auto-fit, minmax(150px,1fr)); gap:18px; padding:16px; justify-items:center; }
  
  /* Card Component */
  .card{ width:100%; max-width:180px; background:var(--card-bg); border-radius:14px; overflow:hidden; box-shadow:0 6px 18px rgba(0,0,0,.08); transition:transform .25s ease, box-shadow .25s ease; }
  .card:hover{ transform:translateY(-6px); box-shadow:0 10px 24px rgba(0,0,0,.15);}
  
  .thumb{ position:relative; aspect-ratio:9/16; background:#000; display:block; cursor: pointer; }
  .thumb img{ width:100%; height:100%; object-fit:cover; display:block;}
  .play{ position:absolute; right:10px; bottom:10px; background:rgba(0,0,0,.6); color:#fff; font-size:11px; padding:5px 9px; border-radius:999px;}
  
  .yt{ text-align:center; padding:8px 10px 12px;}
  .yt a{ color:var(--accent); font-size:.85rem; text-decoration:none;}
  .yt a:hover{ text-decoration:underline; }

  /* Contact Modal */
  .modal{ position:fixed; inset:0; background:rgba(0,0,0,.55); display:none; align-items:center; justify-content:center; z-index:1000; }
  .modal-content{ background:var(--card-bg); color:var(--text); padding:2rem; border-radius:.75rem; width:min(92vw,420px); text-align:center; box-shadow:0 10px 30px rgba(0,0,0,.35); }
  .btn{ background:var(--brand); color:#fff; padding:.6rem 1rem; border-radius:.6rem; }
  .btn:hover{ background:var(--brand-hover); }

  /* Lightbox (Vertical 9:16 Optimized) */
  .lightbox{ position:fixed; inset:0; background:rgba(0,0,0,.85); display:none; align-items:center; justify-content:center; z-index:1100; padding:24px; }
  .lightbox-inner{ width:min(96vw, calc(90vh * 9 / 16)); }
  .lb-close{ position:absolute; top:16px; right:16px; background:rgba(255,255,255,.15); color:#fff; padding:8px 12px; border-radius:8px; cursor:pointer; }

  /* Responsive Grid Adjustments */
  @media (min-width:1280px){ .grid{ grid-template-columns:repeat(6,1fr);} }
  @media (min-width:1024px) and (max-width:1279px){ .grid{ grid-template-columns:repeat(5,1fr);} }
  @media (max-width:768px){
    .header{ font-size:28px; height:200px;}
    .intro{ width:90%; padding:16px;}
    .navbar{ flex-wrap:wrap; padding:10px;}
    .nav-btn{ margin:5px; padding:8px 12px;}
    .grid{ grid-template-columns:repeat(auto-fit,minmax(120px,1fr)); gap:12px; }
    .card{ max-width:45vw; }
  }
</style>
</head>
<body>
  <div class="header">Tony's SkyView Portfolio</div>

  <!-- Navigation Bar -->
  <div class="navbar flex justify-center py-2 shadow-md">
    <a href="index.html" class="nav-btn">Home</a>
    <a href="videos.html" class="nav-btn">Videos</a>
    <a href="shorts.html" class="nav-btn">Shorts</a>
    <a href="https://smile21c.notion.site/my-profile" class="nav-btn" target="_blank" rel="noopener">About Me</a>
    <a href="#" class="nav-btn" id="contact-btn">Contact Me</a>
  </div>

  <!-- Motto/Intro -->
  <div class="intro mx-auto my-8 p-6 rounded-xl shadow-lg w-3/5 text-center">
    자유와 행복이 중요한 이유는 그것들이 삶(생존)의 질(質)을 좋게 하고, 
    양질의 삶을 증가시키기 때문이다.
  </div>

  <hr class="border-t-2 border-gray-300 my-8 w-4/5 mx-auto">

  <!-- Main Video Grid -->
  <div id="shorts" class="text-center py-6">
    <h2 class="video-section-title">9:16 Shorts</h2>
    <!-- Simple Loading State -->
    <div id="loading" class="text-gray-500 mb-4 font-bold">Loading shorts...</div>
    <div id="shorts-container" class="grid"></div>
  </div>

  <!-- Contact Modal -->
  <div id="contact-modal" class="modal" aria-hidden="true">
    <div class="modal-content">
      <h3 class="text-xl font-bold mb-4">Contact Information</h3>
      <p class="text-gray-700 mb-6" style="color:var(--muted)">Email: smile21c@korea.com</p>
      <button id="close-modal-btn" class="btn">Close</button>
    </div>
  </div>

  <!-- Lightbox Player -->
  <div id="lightbox" class="lightbox" aria-hidden="true">
    <div class="lightbox-inner">
      <button class="lb-close" id="lb-close" aria-label="Close video">Close ✕</button>
      <div id="lb-target"></div>
    </div>
  </div>

<script>
  /**
   * [설정] Google Apps Script 배포 URL
   * 주인님께서 제공하신 URL을 사용합니다.
   */
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxdmO5YEMjTvrArVSmqyN0em4IQOzhOSfjf3mWBqlxA_qlht4Hf0udgJJA5uVQrsmmTPQ/exec"; 

  /**
   * YouTube ID Extraction Logic (Robust)
   */
  function getId(url){
    if(!url) return null;
    try{
      const u = new URL(url);
      const v = u.searchParams.get('v');
      if (v && v.length === 11) return v;
      const parts = u.pathname.split('/');
      for (let i = parts.length - 1; i >= 0; i--) {
        const seg = parts[i];
        if (seg && seg.length === 11) return seg;
      }
    }catch(e){
      const m = url.match(/(?:watch\?v=|youtu\.be\/|embed\/|v\/)([A-Za-z0-9_-]{11})/);
      if (m) return m[1];
    }
    return null;
  }

  // Lightbox DOM Elements
  const lb = document.getElementById('lightbox');
  const lbClose = document.getElementById('lb-close');
  const lbTarget = document.getElementById('lb-target');

  function openLB(id){
    lbTarget.innerHTML = `<iframe title="YouTube Shorts player" style="width:100%;aspect-ratio:9/16;border:0;border-radius:12px;" src="https://www.youtube.com/embed/${id}?autoplay=1&mute=1&playsinline=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>`;
    lb.style.display='flex'; 
    lb.setAttribute('aria-hidden','false');
  }

  function closeLB(){ 
    lb.style.display='none'; 
    lb.setAttribute('aria-hidden','true'); 
    lbTarget.innerHTML=''; 
  }

  lbClose.addEventListener('click', closeLB);
  lb.addEventListener('click', e=>{ if(e.target===lb) closeLB(); });
  window.addEventListener('keydown', e=>{ if(e.key==='Escape') closeLB(); });

  /**
   * Render List Logic for Shorts
   */
  function render(list, containerId){
    const el=document.getElementById(containerId); 
    const loadingEl = document.getElementById('loading');
    
    if(!el) return;
    
    // Clear loading message
    if(loadingEl) loadingEl.style.display = 'none';
    el.innerHTML = ''; 

    // Sort by date descending
    list.sort((a,b)=> new Date(b.date)-new Date(a.date));
    
    list.forEach(v=>{
      const id=getId(v.url); 
      if(!id) return; 
      
      const card=document.createElement('div'); 
      card.className='card'; 
      card.setAttribute('role','button'); 
      card.tabIndex=0;
      
      card.innerHTML=`
        <a class="thumb"><img loading="lazy" src="https://img.youtube.com/vi/${id}/hqdefault.jpg" alt="${v.title} 썸네일"><span class="play">Play</span></a>
        <div class="yt"><a href="${v.url}" target="_blank" rel="noopener">[유튜브 바로가기]</a></div>
      `;
      
      const act=(e)=>{ 
        const isYt = e.target.closest('.yt'); 
        if(!isYt){ openLB(id); } 
      };
      card.addEventListener('click', act);
      card.addEventListener('keydown', e=>{ 
        if(e.key==='Enter'||e.key===' '){ 
          e.preventDefault(); 
          openLB(id); 
        }
      });
      el.appendChild(card);
    });
  }

  /**
   * Fetch Data from Google Spreadsheet (Shorts Sheet)
   * 요청 시 '?sheet=shorts' 파라미터를 추가하여 구별합니다.
   */
  async function loadShorts() {
    const loadingEl = document.getElementById('loading');
    try {
      // * KEY POINT: Add query parameter to request specific sheet
      const response = await fetch(SCRIPT_URL + "?sheet=shorts", {
        method: 'GET',
        redirect: 'follow'
      });
      
      if (!response.ok) {
        throw new Error(`HTTP Error Status: ${response.status}`);
      }

      const data = await response.json();
      
      if(!data || !Array.isArray(data) || data.length === 0) {
        if(loadingEl) loadingEl.textContent = 'No shorts found.';
        return;
      }

      render(data, 'shorts-container');
      
    } catch (error) {
      console.error('Fetch error:', error);
      if(loadingEl) {
        loadingEl.textContent = 'Failed to load shorts. Please try again later.';
        loadingEl.style.color = '#ef4444'; 
      }
    }
  }

  // Execution
  loadShorts();

  // Modal Interaction Logic
  const contactBtn=document.getElementById('contact-btn');
  const contactModal=document.getElementById('contact-modal');
  const closeModalBtn=document.getElementById('close-modal-btn');
  
  if(contactBtn && contactModal && closeModalBtn){
    contactBtn.addEventListener('click',e=>{ 
      e.preventDefault(); 
      contactModal.style.display='flex'; 
      contactModal.setAttribute('aria-hidden','false');
    });
    closeModalBtn.addEventListener('click',()=>{ 
      contactModal.style.display='none'; 
      contactModal.setAttribute('aria-hidden','true');
    });
    contactModal.addEventListener('click',e=>{ 
      if(e.target===contactModal){ 
        contactModal.style.display='none'; 
        contactModal.setAttribute('aria-hidden','true');
      }
    });
  }

  // Helper: Open External Links
  document.addEventListener('click', (e)=>{
    const link = e.target.closest('.yt a');
    if(!link) return;
    e.preventDefault();
    const url = link.href;
    const w = window.screen.width, h = window.screen.height;
    const win = window.open(url, '_blank', `scrollbars=yes,width=${w},height=${h},top=0,left=0`);
    if(win && win.focus) win.focus();
  });
</script>
</body>
</html>

